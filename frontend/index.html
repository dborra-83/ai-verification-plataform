<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Verification Platform - Dashboard</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <!-- Custom CSS -->
    <link href="css/styles.css" rel="stylesheet">
    <!-- SweetAlert2 -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Configuration -->
    <script src="config.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <nav class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h1><i class="bi bi-shield-check me-2"></i>AI Verification</h1>
                <p>Plataforma de Verificación</p>
            </div>
            
            <div class="sidebar-nav">
                <a href="index.html" class="nav-item active">
                    <i class="bi bi-speedometer2"></i>
                    Dashboard
                </a>
                <a href="#" class="nav-item" onclick="showUploadSection()">
                    <i class="bi bi-cloud-upload"></i>
                    Nuevo Análisis
                </a>
                <a href="#" class="nav-item" onclick="showHistorySection()">
                    <i class="bi bi-clock-history"></i>
                    Historial
                </a>
                <a href="#" class="nav-item" onclick="showComingSoon('Analytics')">
                    <i class="bi bi-graph-up"></i>
                    Analytics
                </a>
                <a href="#" class="nav-item" onclick="showSettingsSection()">
                    <i class="bi bi-gear"></i>
                    Configuración
                </a>
                <hr style="border-color: rgba(255,255,255,0.2); margin: 1rem 1.5rem;">
                <a href="#" class="nav-item" onclick="logout()">
                    <i class="bi bi-box-arrow-right"></i>
                    Cerrar Sesión
                </a>
            </div>
        </nav>
        
        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <div class="topbar">
                <h2 id="pageTitle">Dashboard</h2>
                <div class="topbar-actions">
                    <div class="search-box">
                        <i class="bi bi-search"></i>
                        <input type="text" placeholder="Buscar análisis..." id="searchInput">
                    </div>
                    <div class="user-avatar" title="Admin">
                        A
                    </div>
                </div>
            </div>
            
            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Section -->
                <div id="dashboardSection">
                    <!-- KPI Cards -->
                    <div class="row mb-4">
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value" id="totalAnalyses">-</h3>
                                    <p class="kpi-label">Total Análisis</p>
                                    <small class="kpi-trend text-muted">Últimos 30 días</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value" id="avgAiScore">-</h3>
                                    <p class="kpi-label">Promedio IA Score</p>
                                    <small class="kpi-trend text-muted">Últimos 30 días</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value text-success" id="systemStatus">Activo</h3>
                                    <p class="kpi-label">Estado del Sistema</p>
                                    <small class="kpi-trend trend-up">
                                        <i class="bi bi-check-circle me-1"></i>Operativo
                                    </small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Additional KPIs -->
                    <div class="row mb-4">
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value text-warning" id="highRiskCount">-</h3>
                                    <p class="kpi-label">Alto Riesgo IA</p>
                                    <small class="kpi-trend text-muted">Score > 70%</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value text-info" id="avgOriginalityScore">-</h3>
                                    <p class="kpi-label">Promedio Originalidad</p>
                                    <small class="kpi-trend text-muted">Últimos 30 días</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value text-primary" id="todayAnalyses">-</h3>
                                    <p class="kpi-label">Análisis Hoy</p>
                                    <small class="kpi-trend text-muted">Últimas 24 horas</small>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="card">
                                <div class="card-body kpi-card">
                                    <h3 class="kpi-value text-success" id="avgConfidence">-</h3>
                                    <p class="kpi-label">Confianza Promedio</p>
                                    <small class="kpi-trend text-muted">Precisión del análisis</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div class="row mb-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">
                                        <i class="bi bi-plus-circle me-2"></i>
                                        Nuevo Análisis
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="row align-items-center">
                                        <div class="col-md-8">
                                            <p class="text-muted mb-3">Sube un documento PDF para analizar el uso de IA con tecnología Amazon Bedrock Claude 3.5 Sonnet</p>
                                            <button class="btn btn-primary" onclick="showUploadSection()">
                                                <i class="bi bi-cloud-upload me-2"></i>
                                                Subir Documento
                                            </button>
                                        </div>
                                        <div class="col-md-4 text-center">
                                            <div class="d-flex justify-content-center align-items-center">
                                                <div class="me-3">
                                                    <i class="bi bi-robot" style="font-size: 2rem; color: var(--ch-blue);"></i>
                                                </div>
                                                <div class="text-start">
                                                    <small class="text-muted">Powered by</small><br>
                                                    <strong>Amazon Bedrock</strong><br>
                                                    <small class="text-muted">Claude 3.5 Sonnet</small>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Recent Analyses -->
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">
                                <i class="bi bi-clock-history me-2"></i>
                                Análisis Recientes
                            </h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Estudiante</th>
                                            <th>Curso</th>
                                            <th>Fecha</th>
                                            <th>IA Score</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="recentAnalysesTable">
                                        <tr>
                                            <td colspan="6" class="text-center text-muted">
                                                <i class="bi bi-hourglass-split me-2"></i>
                                                Cargando análisis recientes...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Upload Section -->
                <div id="uploadSection" style="display: none;">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">
                                        <i class="bi bi-cloud-upload me-2"></i>
                                        Subir Documento para Análisis
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <form id="uploadForm">
                                        <!-- Upload Zone -->
                                        <div class="upload-zone mb-4" id="uploadZone">
                                            <div class="upload-icon">
                                                <i class="bi bi-cloud-upload"></i>
                                            </div>
                                            <div class="upload-text">
                                                Arrastra tu archivo PDF aquí
                                            </div>
                                            <div class="upload-subtext">
                                                o haz clic para seleccionar archivo
                                            </div>
                                            <input type="file" id="fileInput" accept=".pdf" style="display: none;">
                                        </div>
                                        
                                        <!-- File Info -->
                                        <div id="fileInfo" style="display: none;" class="alert alert-info mb-4">
                                            <i class="bi bi-file-earmark-pdf me-2"></i>
                                            <span id="fileName"></span>
                                            <button type="button" class="btn-close float-end" onclick="clearFile()"></button>
                                        </div>
                                        
                                        <!-- Metadata Form -->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="studentName" class="form-label">Nombre del Estudiante *</label>
                                                    <input type="text" class="form-control" id="studentName" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="studentId" class="form-label">ID del Estudiante</label>
                                                    <input type="text" class="form-control" id="studentId">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="course" class="form-label">Curso *</label>
                                                    <input type="text" class="form-control" id="course" required>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="mb-3">
                                                    <label for="subject" class="form-label">Materia</label>
                                                    <input type="text" class="form-control" id="subject">
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="mb-4">
                                            <label for="assignmentName" class="form-label">Nombre de la Tarea *</label>
                                            <input type="text" class="form-control" id="assignmentName" required>
                                        </div>
                                        
                                        <div class="d-flex gap-2">
                                            <button type="submit" class="btn btn-primary" id="analyzeBtn" disabled>
                                                <i class="bi bi-play-circle me-2"></i>
                                                Iniciar Análisis
                                            </button>
                                            <button type="button" class="btn btn-secondary" onclick="showDashboard()">
                                                <i class="bi bi-arrow-left me-2"></i>
                                                Volver al Dashboard
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-info-circle me-2"></i>
                                        Información
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <h6>Formatos Soportados</h6>
                                    <ul class="list-unstyled">
                                        <li><i class="bi bi-check-circle text-success me-2"></i>PDF con texto</li>
                                        <li><i class="bi bi-exclamation-circle text-warning me-2"></i>PDF escaneado (limitado)</li>
                                    </ul>
                                    
                                    <h6 class="mt-3">Proceso de Análisis</h6>
                                    <ol class="small">
                                        <li>Extracción de texto del PDF</li>
                                        <li>Análisis con Amazon Bedrock</li>
                                        <li>Generación de informe</li>
                                        <li>Almacenamiento de resultados</li>
                                    </ol>
                                    
                                    <div class="alert alert-warning mt-3">
                                        <small>
                                            <i class="bi bi-exclamation-triangle me-1"></i>
                                            Los PDFs escaneados requieren OCR (Fase 2)
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- History Section -->
                <div id="historySection" style="display: none;">
                    <div class="card">
                        <div class="card-header">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h5 class="mb-0">
                                        <i class="bi bi-clock-history me-2"></i>
                                        Historial de Análisis
                                    </h5>
                                </div>
                                <div class="col-auto">
                                    <button class="btn btn-secondary" onclick="showDashboard()">
                                        <i class="bi bi-arrow-left me-2"></i>
                                        Volver al Dashboard
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Filters -->
                            <div class="row mb-3">
                                <div class="col-md-3">
                                    <label for="filterCourse" class="form-label">Filtrar por Curso</label>
                                    <select class="form-select" id="filterCourse">
                                        <option value="">Todos los cursos</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="filterFrom" class="form-label">Desde</label>
                                    <input type="date" class="form-control" id="filterFrom">
                                </div>
                                <div class="col-md-3">
                                    <label for="filterTo" class="form-label">Hasta</label>
                                    <input type="date" class="form-control" id="filterTo">
                                </div>
                                <div class="col-md-3 d-flex align-items-end">
                                    <button class="btn btn-primary" onclick="applyFilters()">
                                        <i class="bi bi-funnel me-2"></i>
                                        Filtrar
                                    </button>
                                </div>
                            </div>
                            
                            <!-- History Table -->
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Estudiante</th>
                                            <th>Curso</th>
                                            <th>Tarea</th>
                                            <th>Fecha</th>
                                            <th>IA Score</th>
                                            <th>Originalidad</th>
                                            <th>Estado</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody id="historyTable">
                                        <tr>
                                            <td colspan="8" class="text-center text-muted">
                                                <i class="bi bi-hourglass-split me-2"></i>
                                                Cargando historial...
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            
                            <!-- Pagination -->
                            <nav aria-label="Paginación del historial">
                                <ul class="pagination justify-content-center" id="historyPagination">
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Section -->
                <div id="settingsSection" style="display: none;">
                    <div class="row">
                        <div class="col-md-8">
                            <div class="card">
                                <div class="card-header">
                                    <div class="row align-items-center">
                                        <div class="col">
                                            <h5 class="mb-0">
                                                <i class="bi bi-gear me-2"></i>
                                                Configuración
                                            </h5>
                                        </div>
                                        <div class="col-auto">
                                            <button class="btn btn-secondary" onclick="showDashboard()">
                                                <i class="bi bi-arrow-left me-2"></i>
                                                Volver al Dashboard
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                <div class="card-body">
                                    <form id="settingsForm">
                                        <!-- Dashboard Settings -->
                                        <div class="mb-4">
                                            <h6 class="text-primary mb-3">
                                                <i class="bi bi-speedometer2 me-2"></i>
                                                Configuración del Dashboard
                                            </h6>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="kpiPeriod" class="form-label">Período de KPIs</label>
                                                        <select class="form-select" id="kpiPeriod">
                                                            <option value="7">Últimos 7 días</option>
                                                            <option value="15">Últimos 15 días</option>
                                                            <option value="30" selected>Últimos 30 días</option>
                                                            <option value="90">Últimos 90 días</option>
                                                        </select>
                                                        <small class="text-muted">Período para calcular las métricas del dashboard</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="itemsPerPage" class="form-label">Elementos por Página</label>
                                                        <select class="form-select" id="itemsPerPage">
                                                            <option value="5" selected>5 elementos</option>
                                                            <option value="10">10 elementos</option>
                                                            <option value="20">20 elementos</option>
                                                            <option value="50">50 elementos</option>
                                                        </select>
                                                        <small class="text-muted">Número de análisis mostrados en las tablas</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="highRiskThreshold" class="form-label">Umbral Alto Riesgo IA</label>
                                                        <select class="form-select" id="highRiskThreshold">
                                                            <option value="60">60% o más</option>
                                                            <option value="70" selected>70% o más</option>
                                                            <option value="80">80% o más</option>
                                                        </select>
                                                        <small class="text-muted">Score mínimo para considerar "Alto Riesgo"</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Actualización Automática</label>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="autoRefresh" checked>
                                                            <label class="form-check-label" for="autoRefresh">
                                                                Actualizar dashboard automáticamente
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Actualiza los KPIs cada 2 minutos</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Interface Settings -->
                                        <div class="mb-4">
                                            <h6 class="text-primary mb-3">
                                                <i class="bi bi-palette me-2"></i>
                                                Configuración de Interfaz
                                            </h6>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="theme" class="form-label">Tema</label>
                                                        <select class="form-select" id="theme">
                                                            <option value="light" selected>Claro</option>
                                                            <option value="dark">Oscuro</option>
                                                            <option value="auto">Automático</option>
                                                        </select>
                                                        <small class="text-muted">Apariencia de la interfaz</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label for="fontSize" class="form-label">Tamaño de Fuente</label>
                                                        <select class="form-select" id="fontSize">
                                                            <option value="normal" selected>Normal</option>
                                                            <option value="large">Grande</option>
                                                        </select>
                                                        <small class="text-muted">Tamaño del texto en la interfaz</small>
                                                    </div>
                                                </div>
                                            </div>
                                            
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Animaciones</label>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="animations" checked>
                                                            <label class="form-check-label" for="animations">
                                                                Activar animaciones y transiciones
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Efectos visuales en la interfaz</small>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="mb-3">
                                                        <label class="form-label">Sonidos</label>
                                                        <div class="form-check form-switch">
                                                            <input class="form-check-input" type="checkbox" id="sounds">
                                                            <label class="form-check-label" for="sounds">
                                                                Activar sonidos de notificación
                                                            </label>
                                                        </div>
                                                        <small class="text-muted">Sonidos para alertas y confirmaciones</small>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <!-- Action Buttons -->
                                        <div class="d-flex gap-2">
                                            <button type="submit" class="btn btn-primary">
                                                <i class="bi bi-check-circle me-2"></i>
                                                Guardar Configuración
                                            </button>
                                            <button type="button" class="btn btn-outline-secondary" onclick="resetSettings()">
                                                <i class="bi bi-arrow-clockwise me-2"></i>
                                                Restaurar Predeterminados
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-4">
                            <div class="card">
                                <div class="card-header">
                                    <h6 class="mb-0">
                                        <i class="bi bi-info-circle me-2"></i>
                                        Información del Sistema
                                    </h6>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <small class="text-muted">Versión de la Plataforma</small>
                                        <div class="fw-medium">v1.0.0</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <small class="text-muted">Modelo de IA</small>
                                        <div class="fw-medium">Claude 3.5 Sonnet</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <small class="text-muted">Región AWS</small>
                                        <div class="fw-medium">us-east-1</div>
                                    </div>
                                    
                                    <div class="mb-3">
                                        <small class="text-muted">Estado del Sistema</small>
                                        <div class="fw-medium text-success">
                                            <i class="bi bi-check-circle me-1"></i>
                                            Operativo
                                        </div>
                                    </div>
                                    
                                    <hr>
                                    
                                    <div class="mb-3">
                                        <small class="text-muted">Configuración Guardada</small>
                                        <div class="fw-medium" id="lastSaved">
                                            <i class="bi bi-clock me-1"></i>
                                            Nunca
                                        </div>
                                    </div>
                                    
                                    <div class="alert alert-info">
                                        <small>
                                            <i class="bi bi-info-circle me-1"></i>
                                            La configuración se guarda localmente en tu navegador.
                                        </small>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Custom JS -->
    <script src="js/app.js"></script>
    <script src="js/upload.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html>